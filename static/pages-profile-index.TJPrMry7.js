import{t as e,k as a,l,c as s,d as t,r as c,I as n,S as o,K as u,M as i,L as r,b as d,h as f,E as _}from"./uni.CnKTWU0K.js";import{b as p,o as m,Z as v}from"./index-C3v_m0JD.js";import{d as g,r as k,b,R as y,a6 as w,ad as h,a7 as x,M as C,aW as j,aP as F,_ as I,aX as T,aY as E,aN as O,az as S,ak as V}from"./vendor.CqD9dFNX.js";import{C as N}from"./CustomTabBar.D3O6WTuX.js";import{r as D,s as $}from"./loginHelper.B8-BL7my.js";import{_ as A}from"./_plugin-vue_export-helper.BCo6x5W8.js";const B=A(g({__name:"index",setup(g){const A=k({user_id:"",nickname:"",mobile:"",avatar:"",balance:0,is_admin:!1}),B=b(!1),H=b(!1),J=b(0),M=b(!0),P=b("19.90"),U=b(!0),z=k({hasWeeklyCard:!1,expireTime:null,remainingDays:0,remainingHours:0}),W=b(!1),L=b(null),R=b([]),Z=b(!1),K=b("login"),X=k({mobile:"",password:"",nickname:""}),Y=b(0),q=b(0);p((()=>{const a=e();Y.value=a.statusBarHeight||0,q.value=Y.value+44,G()}));const G=async()=>{M.value=!0};y((()=>{ee()})),m((()=>{console.log("onShow - 开始检查登录状态");const e=a("token"),l=a("tokenExpire");console.log("当前token状态:",{hasToken:!!e,tokenExpire:l,now:Date.now()}),e&&l&&Date.now()<l?(B.value=!0,ae(),te(),_e()):(console.log("token无效或已过期"),B.value=!1,U.value=!1,le(!1))}));const Q=e=>{try{l("userInfo",JSON.stringify(e))}catch(a){console.error("存储用户信息失败",a)}},ee=async()=>{try{const l=(()=>{try{const e=a("token"),l=a("tokenExpire");return e&&l?{token:e,tokenExpire:l}:null}catch(e){return console.error("获取存储的token信息失败",e),null}})();if(!l)return B.value=!1,void(U.value=!1);if(Date.now()>l.tokenExpire)return void le(!1);const s=a("userInfo");if(s)try{const e=JSON.parse(s);Object.assign(A,e),B.value=!0,H.value=!!e.is_admin,_e()}catch(e){console.error("解析用户信息失败",e),B.value=!1,U.value=!1}else B.value=!1,U.value=!1}catch(l){console.error("检查登录状态失败",l),B.value=!1,U.value=!1}},ae=async()=>{try{const c=a("token");if(!c)return void console.log("未找到token，无法获取用户信息");const n=await(async()=>{try{const e=a("token");if(!e)return console.log("未找到token"),!1;const{result:l}=await v.callFunction({name:"user",data:{action:"testToken",token:e}});return console.log("Token测试结果:",l),l&&0===l.code}catch(e){return console.error("Token测试失败:",e),!1}})();if(!n)return console.log("token验证失败，清除登录状态"),B.value=!1,void le(!1);const{result:o}=await v.callFunction({name:"user",data:{action:"getBalance",token:c}});if(console.log("获取用户余额结果:",o),o&&0===o.code){A.balance=Number(o.balance),console.log("用户余额更新成功:",A.balance);try{const{result:e}=await v.callFunction({name:"user",data:{action:"checkAdminStatus",token:c}});console.log("管理员状态查询结果:",e),e&&0===e.code?(A.is_admin=e.is_admin,H.value=e.is_admin,console.log("管理员状态更新成功:",H.value)):(console.warn("管理员状态查询失败:",(null==e?void 0:e.msg)||(null==e?void 0:e.message)),A.is_admin=!1,H.value=!1)}catch(e){console.error("管理员状态查询异常:",e),A.is_admin=!1,H.value=!1}const s=a("userInfo");if(s)try{const e=JSON.parse(s);e.balance=Number(o.balance),e.is_admin=A.is_admin,l("userInfo",JSON.stringify(e)),console.log("本地用户信息更新成功")}catch(t){console.error("更新本地用户信息失败",t)}}else console.error("获取用户余额失败:",o),console.error("错误代码:",null==o?void 0:o.code),console.error("错误信息:",(null==o?void 0:o.message)||(null==o?void 0:o.msg)),401===(null==o?void 0:o.code)||403===(null==o?void 0:o.code)?(console.log("token无效，清除登录状态"),B.value=!1,le(!1)):s({title:(null==o?void 0:o.message)||(null==o?void 0:o.msg)||"获取用户信息失败",icon:"none",duration:2e3})}catch(c){console.error("获取用户信息失败:",c),B.value=!1,le(!1)}},le=async(e=!0)=>{const a=async()=>{try{await v.callFunction({name:"user",data:{action:"logout"}})}catch(a){console.error("调用登出接口失败",a)}D(),c("userInfo"),c("userId"),B.value=!1,H.value=!1,Object.assign(A,{user_id:"",nickname:"",mobile:"",avatar:"",balance:0,is_admin:!1}),e&&s({title:"已退出登录",icon:"success"})};e?t({title:"提示",content:"确认退出登录？",success:e=>{e.confirm&&a()}}):await a()},se=async()=>{var e;try{if(!we())return;if(!he())return;d({title:"登录中..."});const a=await v.callFunction({name:"user",data:{action:"login",data:{mobile:X.mobile,password:X.password}}});if(f(),a.result&&0===a.result.code){const{token:e,tokenExpire:t,userInfo:c}=a.result.data;console.log("登录成功，获取到的数据:",{token:e,tokenExpire:t,userInfo:c}),$(e,t),l("userId",c.user_id),Object.assign(A,c),H.value=!!c.is_admin,Q(c),B.value=!0,s({title:"登录成功",icon:"success"}),setTimeout((()=>{ae(),te(),_e()}),500)}else console.error("登录失败:",a.result),s({title:(null==(e=a.result)?void 0:e.msg)||"登录失败",icon:"none"})}catch(a){f(),console.error("登录失败",a),s({title:"登录失败，请检查云函数",icon:"none"})}},te=async()=>{J.value=0},ce=()=>{const e=A.balance;_({url:`/packageA/components/Recharge?balance=${e}`})},ne=()=>{_({url:"/pages/coupons/index"})},oe=()=>{_({url:"/pages/order/index"})},ue=()=>{_({url:"/pages/group/index"})},ie=()=>{_({url:"/pages/profile/setting"})},re=()=>{_({url:"/pages/admin/admin-panel"})},de=async()=>{try{const{result:e}=await v.callFunction({name:"weeklyCard",data:{action:"getPrice",token:a("token")}});e&&0===e.code&&(P.value=e.data.price.toFixed(2))}catch(e){console.error("加载周卡价格失败:",e)}},fe=async()=>{try{const{result:e}=await v.callFunction({name:"weeklyCard",data:{action:"getUserStatus",token:a("token")}});e&&0===e.code&&Object.assign(z,e.data)}catch(e){console.error("加载周卡状态失败:",e)}},_e=async()=>{U.value=!0;try{await Promise.all([de(),fe()])}catch(e){console.error("加载周卡数据失败:",e)}finally{U.value=!1}},pe=e=>{W.value=!0,me()},me=async()=>{try{console.log("开始加载可用优惠券");const{result:e}=await v.callFunction({name:"coupon",data:{action:"getList",status:"unused",page:1,pageSize:50,token:a("token")}});console.log("优惠券查询结果:",e),e&&0===e.code?(R.value=e.data.list||[],console.log("加载到的优惠券数量:",R.value.length)):(console.error("优惠券查询失败:",e),R.value=[])}catch(e){console.error("加载优惠券失败:",e),R.value=[]}},ve=()=>{let e=parseFloat(P.value);if(L.value){const a=R.value.find((e=>e._id===L.value));if(a){const l=Math.min(a.amount,e);return Math.max(0,e-l)}}return e},ge=async()=>{if(!Z.value){Z.value=!0;try{const{result:e}=await v.callFunction({name:"weeklyCard",data:{action:"purchase",token:a("token"),couponId:L.value}});e&&0===e.code?(s({title:"开通成功",icon:"success"}),W.value=!1,L.value=null,await Promise.all([ae(),_e(),te()]),setTimeout((()=>{s({title:"周卡权益已生效",icon:"success",duration:2e3})}),800)):s({title:(null==e?void 0:e.msg)||"购买失败",icon:"none"})}catch(e){console.error("购买周卡失败:",e),s({title:"购买失败",icon:"none"})}Z.value=!1}},ke=async()=>{var e;try{if(!we())return;if(!he())return;d({title:"注册中..."});const a=await v.callFunction({name:"user",data:{action:"register",data:{mobile:X.mobile,password:X.password,nickname:X.nickname||`用户${X.mobile.substring(7)}`}}});if(f(),a.result&&0===a.result.code){const{token:e,tokenExpire:t,userInfo:c}=a.result.data;$(e,t),l("userId",c.user_id),Object.assign(A,c),Q(c),B.value=!0,s({title:"注册成功",icon:"success"}),setTimeout((()=>{ae(),te(),_e()}),500)}else s({title:(null==(e=a.result)?void 0:e.msg)||"注册失败",icon:"none"})}catch(a){f(),console.error("注册失败",a),s({title:"注册失败，请检查云函数",icon:"none"})}},be=b(""),ye=b(""),we=()=>X.mobile?/^1[3-9]\d{9}$/.test(X.mobile)?(be.value="",!0):(be.value="请输入正确的手机号格式",!1):(be.value="请输入手机号",!1),he=()=>X.password?"register"!==K.value||/^(?=.*[a-zA-Z])(?=.*\d)(?=.*[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]).{6,12}$/.test(X.password)?(ye.value="",!0):(ye.value="密码必须为6-12位，包含字母、数字和特殊符号",!1):(ye.value="请输入密码",!1);return(e,a)=>{const l=n,s=u,t=i,c=r,d=o;return x(),w(l,{class:"page-container"},{default:h((()=>[C(l,{class:"profile-background-image"}),C(d,{"scroll-y":"true",class:"scroll-container",style:{paddingBottom:"150rpx"}},{default:h((()=>[C(l,{class:"content-main"},{default:h((()=>[C(l,{class:"user-profile-section",style:F({paddingTop:q.value+30+"px"})},{default:h((()=>[B.value?(x(),w(l,{key:1,class:"user-info"},{default:h((()=>[C(l,{class:"avatar-section"},{default:h((()=>[C(l,{class:"avatar-wrapper"},{default:h((()=>[C(l,{class:"avatar-ring"}),C(l,{class:"avatar-placeholder"},{default:h((()=>[C(s,{class:"avatar-text"},{default:h((()=>[I(E((A.nickname||"用户").charAt(0)),1)])),_:1})])),_:1})])),_:1})])),_:1}),C(l,{class:"user-info-card"},{default:h((()=>[C(l,{class:"user-basic-info"},{default:h((()=>[C(s,{class:"nickname"},{default:h((()=>[I(E(A.nickname||"用户"),1)])),_:1}),C(s,{class:"mobile"},{default:h((()=>[I(E(A.mobile||""),1)])),_:1})])),_:1}),C(l,{class:"balance-section"},{default:h((()=>[C(l,{class:"balance-card"},{default:h((()=>[C(l,{class:"balance-label"},{default:h((()=>[I("我的余额")])),_:1}),C(l,{class:"balance-amount"},{default:h((()=>[C(s,{class:"currency"},{default:h((()=>[I("¥")])),_:1}),C(s,{class:"amount"},{default:h((()=>{return[I(E((e=A.balance||0,Number(e).toFixed(2))),1)];var e})),_:1})])),_:1})])),_:1})])),_:1}),C(l,{class:"weekly-card-section"},{default:h((()=>[U.value?(x(),w(l,{key:0,class:"weekly-card-loading"},{default:h((()=>[C(l,{class:"loading-content"},{default:h((()=>[C(l,{class:"loading-spinner"}),C(s,{class:"loading-text"},{default:h((()=>[I("加载周卡信息中...")])),_:1})])),_:1})])),_:1})):z.hasWeeklyCard?(x(),w(l,{key:1,class:"weekly-card-active"},{default:h((()=>[C(l,{class:"card-header"},{default:h((()=>[C(s,{class:"card-icon"},{default:h((()=>[I("💎")])),_:1}),C(s,{class:"card-title"},{default:h((()=>[I("周卡会员")])),_:1}),C(s,{class:"card-status"},{default:h((()=>[I("已开通")])),_:1})])),_:1}),C(l,{class:"card-countdown"},{default:h((()=>[z.remainingDays>0?(x(),w(s,{key:0,class:"countdown-text"},{default:h((()=>[I(" 剩余 "+E(z.remainingDays)+"天"+E(z.remainingHours)+"小时 ",1)])),_:1})):(x(),w(s,{key:1,class:"countdown-text expiring"},{default:h((()=>[I(" 今日到期 ")])),_:1}))])),_:1}),C(l,{class:"card-actions"},{default:h((()=>[C(l,{class:"action-btn renew-btn",onClick:a[5]||(a[5]=e=>pe())},{default:h((()=>[C(s,null,{default:h((()=>[I("续费")])),_:1})])),_:1})])),_:1})])),_:1})):(x(),w(l,{key:2,class:"weekly-card-inactive",onClick:a[6]||(a[6]=e=>pe())},{default:h((()=>[C(l,{class:"weekly-card-header"},{default:h((()=>[C(l,{class:"card-icon-sparkle"},{default:h((()=>[I("✨")])),_:1}),C(s,{class:"weekly-card-main-title"},{default:h((()=>[I("开通周卡会员")])),_:1}),C(l,{class:"card-icon-sparkle"},{default:h((()=>[I("✨")])),_:1})])),_:1}),C(l,{class:"weekly-price-section"},{default:h((()=>[C(s,{class:"price-currency"},{default:h((()=>[I("￥")])),_:1}),C(s,{class:"price-amount"},{default:h((()=>[I(E(P.value),1)])),_:1}),C(s,{class:"price-period"},{default:h((()=>[I("/7天")])),_:1})])),_:1}),C(l,{class:"benefits-section"},{default:h((()=>[C(l,{class:"benefit-row"},{default:h((()=>[C(s,{class:"benefit-icon"},{default:h((()=>[I("🔥")])),_:1}),C(s,{class:"benefit-text"},{default:h((()=>[I("查看所有推荐内容")])),_:1})])),_:1}),C(l,{class:"benefit-row"},{default:h((()=>[C(s,{class:"benefit-icon"},{default:h((()=>[I("💬")])),_:1}),C(s,{class:"benefit-text"},{default:h((()=>[I("加入同步群聊统一查看")])),_:1})])),_:1}),C(l,{class:"benefit-row"},{default:h((()=>[C(s,{class:"benefit-icon"},{default:h((()=>[I("💎")])),_:1}),C(s,{class:"benefit-text"},{default:h((()=>[I("专享会员权限")])),_:1})])),_:1})])),_:1}),C(l,{class:"purchase-button"},{default:h((()=>[C(l,{class:"button-bg"}),C(s,{class:"button-text"},{default:h((()=>[I("立即开通会员")])),_:1}),C(l,{class:"button-arrow"},{default:h((()=>[I("→")])),_:1})])),_:1})])),_:1}))])),_:1})])),_:1})])),_:1})):(x(),w(l,{key:0,class:"login-buttons"},{default:h((()=>[C(l,{class:"welcome-text"},{default:h((()=>[I("欢迎使用极速体育")])),_:1}),C(l,{class:"tab-container"},{default:h((()=>[C(l,{class:T(["tab",{active:"login"===K.value}]),onClick:a[0]||(a[0]=e=>K.value="login")},{default:h((()=>[I("登录")])),_:1},8,["class"]),C(l,{class:T(["tab",{active:"register"===K.value}]),onClick:a[1]||(a[1]=e=>K.value="register")},{default:h((()=>[I("注册")])),_:1},8,["class"])])),_:1}),C(l,{class:"phone-input-container"},{default:h((()=>[C(s,{class:"input-icon"},{default:h((()=>[I("📱")])),_:1}),C(t,{class:"phone-input",type:"number",modelValue:X.mobile,"onUpdate:modelValue":a[2]||(a[2]=e=>X.mobile=e),placeholder:"请输入手机号",maxlength:"11"},null,8,["modelValue"]),be.value?(x(),w(l,{key:0,class:"error-tip"},{default:h((()=>[I(E(be.value),1)])),_:1})):j("",!0)])),_:1}),C(l,{class:"phone-input-container"},{default:h((()=>[C(s,{class:"input-icon"},{default:h((()=>[I("🔒")])),_:1}),C(t,{class:"phone-input",type:"text",modelValue:X.password,"onUpdate:modelValue":a[3]||(a[3]=e=>X.password=e),placeholder:"请输入密码"},null,8,["modelValue"]),ye.value?(x(),w(l,{key:0,class:"error-tip"},{default:h((()=>[I(E(ye.value),1)])),_:1})):j("",!0),"register"===K.value?(x(),w(l,{key:1,class:"password-hint"},{default:h((()=>[I("密码需包含字母、数字和特殊符号")])),_:1})):j("",!0)])),_:1}),"register"===K.value?(x(),w(l,{key:0,class:"phone-input-container"},{default:h((()=>[C(s,{class:"input-icon"},{default:h((()=>[I("👤")])),_:1}),C(t,{class:"phone-input",type:"text",modelValue:X.nickname,"onUpdate:modelValue":a[4]||(a[4]=e=>X.nickname=e),placeholder:"请输入用户名（选填）"},null,8,["modelValue"])])),_:1})):j("",!0),"login"===K.value?(x(),w(c,{key:1,class:"login-btn",onClick:se},{default:h((()=>[I("手机号登录")])),_:1})):(x(),w(c,{key:2,class:"login-btn register-btn",onClick:ke},{default:h((()=>[I("注册账号")])),_:1}))])),_:1}))])),_:1},8,["style"]),B.value&&H.value?(x(),w(l,{key:0,class:"admin-button-section"},{default:h((()=>[C(c,{class:"admin-btn",onClick:re},{default:h((()=>[I("管理员面板")])),_:1})])),_:1})):j("",!0),B.value?(x(),w(l,{key:1,class:"function-cards-section"},{default:h((()=>[C(l,{class:"main-cards-row"},{default:h((()=>[C(l,{class:"main-card-item subscribe-card",onClick:ue},{default:h((()=>[C(l,{class:"card-icon-wrapper"},{default:h((()=>[C(l,{class:"card-icon subscribe-icon"},{default:h((()=>[C(s,{class:"icon-emoji"},{default:h((()=>[I("📺")])),_:1})])),_:1})])),_:1}),C(l,{class:"card-content"},{default:h((()=>[C(s,{class:"card-title"},{default:h((()=>[I("我的订阅")])),_:1}),C(s,{class:"card-desc"},{default:h((()=>[I("查看订阅内容")])),_:1})])),_:1}),C(l,{class:"card-arrow"},{default:h((()=>[I("›")])),_:1})])),_:1}),C(l,{class:"main-card-item purchase-card",onClick:oe},{default:h((()=>[C(l,{class:"card-icon-wrapper"},{default:h((()=>[C(l,{class:"card-icon purchase-icon"},{default:h((()=>[C(s,{class:"icon-emoji"},{default:h((()=>[I("🛒")])),_:1})])),_:1})])),_:1}),C(l,{class:"card-content"},{default:h((()=>[C(s,{class:"card-title"},{default:h((()=>[I("购买记录")])),_:1}),C(s,{class:"card-desc"},{default:h((()=>[I("查看订单历史")])),_:1})])),_:1}),C(l,{class:"card-arrow"},{default:h((()=>[I("›")])),_:1})])),_:1})])),_:1}),C(l,{class:"recharge-card-wrapper"},{default:h((()=>[C(l,{class:"recharge-card modern-recharge",onClick:ce},{default:h((()=>[C(l,{class:"recharge-icon-bg"},{default:h((()=>[C(s,{class:"recharge-icon"},{default:h((()=>[I("💰")])),_:1}),C(l,{class:"icon-glow"})])),_:1}),C(l,{class:"recharge-content"},{default:h((()=>[C(s,{class:"recharge-title"},{default:h((()=>[I("余额充值")])),_:1}),C(s,{class:"recharge-desc"},{default:h((()=>[I("快速充值，享受更多服务")])),_:1})])),_:1}),C(l,{class:"recharge-arrow"},{default:h((()=>[C(s,{class:"arrow-text"},{default:h((()=>[I("›")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})):j("",!0),B.value?j("",!0):(x(),w(l,{key:2,class:"not-login-tips"},{default:h((()=>[C(l,{class:"tips-text"},{default:h((()=>[I("登录后可查看更多功能")])),_:1})])),_:1})),B.value?(x(),w(l,{key:3,class:"settings-section"},{default:h((()=>[C(l,{class:"settings-title"},{default:h((()=>[C(s,{class:"title-text"},{default:h((()=>[I("更多服务")])),_:1}),C(l,{class:"title-line"})])),_:1}),C(l,{class:"settings-grid modern-grid"},{default:h((()=>[C(l,{class:"setting-item coupon-item",onClick:ne},{default:h((()=>[C(l,{class:"setting-icon-wrapper"},{default:h((()=>[C(l,{class:"setting-icon coupon-icon"},{default:h((()=>[C(s,{class:"service-emoji"},{default:h((()=>[I("🎫")])),_:1})])),_:1})])),_:1}),C(s,{class:"setting-text"},{default:h((()=>[I("优惠券")])),_:1})])),_:1}),C(l,{class:"setting-item service-item"},{default:h((()=>[C(c,{"open-type":"contact",class:"contact-btn"},{default:h((()=>[C(l,{class:"setting-icon-wrapper"},{default:h((()=>[C(l,{class:"setting-icon service-icon"},{default:h((()=>[C(s,{class:"service-emoji"},{default:h((()=>[I("💬")])),_:1})])),_:1})])),_:1}),C(s,{class:"setting-text"},{default:h((()=>[I("客服")])),_:1})])),_:1})])),_:1}),C(l,{class:"setting-item settings-item",onClick:ie},{default:h((()=>[C(l,{class:"setting-icon-wrapper"},{default:h((()=>[C(l,{class:"setting-icon setting-icon"},{default:h((()=>[C(s,{class:"service-emoji"},{default:h((()=>[I("⚙️")])),_:1})])),_:1})])),_:1}),C(s,{class:"setting-text"},{default:h((()=>[I("设置")])),_:1})])),_:1}),C(l,{class:"setting-item logout-item",onClick:le},{default:h((()=>[C(l,{class:"setting-icon-wrapper"},{default:h((()=>[C(l,{class:"setting-icon logout-icon"},{default:h((()=>[I("🚪")])),_:1})])),_:1}),C(s,{class:"setting-text"},{default:h((()=>[I("退出")])),_:1})])),_:1})])),_:1})])),_:1})):j("",!0),C(l,{style:{height:"180rpx"}})])),_:1})])),_:1}),W.value?(x(),w(l,{key:0,class:"weekly-card-popup"},{default:h((()=>[C(l,{class:"popup-overlay",onClick:a[7]||(a[7]=e=>W.value=!1)}),C(l,{class:"popup-content"},{default:h((()=>[C(l,{class:"popup-header"},{default:h((()=>[C(s,{class:"popup-title"},{default:h((()=>[I("开通周卡会员")])),_:1}),C(l,{class:"close-btn",onClick:a[8]||(a[8]=e=>W.value=!1)},{default:h((()=>[I("✕")])),_:1})])),_:1}),C(l,{class:"price-info"},{default:h((()=>[C(l,{class:"original-price"},{default:h((()=>[C(s,{class:"price-label"},{default:h((()=>[I("原价")])),_:1}),C(s,{class:"price-value"},{default:h((()=>[I("¥"+E(P.value),1)])),_:1})])),_:1}),C(l,{class:"final-price"},{default:h((()=>[C(s,{class:"price-label"},{default:h((()=>[I("实付")])),_:1}),C(s,{class:"price-value final"},{default:h((()=>[I("¥"+E(ve().toFixed(2)),1)])),_:1})])),_:1})])),_:1}),C(l,{class:"coupon-section"},{default:h((()=>[C(s,{class:"section-title"},{default:h((()=>[I("选择优惠券")])),_:1}),0===R.value.length?(x(),w(l,{key:0,class:"no-coupons"},{default:h((()=>[C(s,null,{default:h((()=>[I("暂无可用优惠券")])),_:1})])),_:1})):(x(),w(d,{key:1,class:"coupon-scroll-area","scroll-y":"true"},{default:h((()=>[C(l,{class:"coupon-list"},{default:h((()=>[(x(!0),O(S,null,V(R.value,(e=>(x(),w(l,{key:e._id,class:T(["coupon-item",{selected:L.value===e._id}]),onClick:a=>(e=>{L.value===e._id?L.value=null:L.value=e._id})(e)},{default:h((()=>[C(l,{class:"coupon-info"},{default:h((()=>[C(s,{class:"coupon-amount"},{default:h((()=>[I("¥"+E(e.amount),1)])),_:2},1024),C(s,{class:"coupon-desc"},{default:h((()=>[I(E(e.title||e.description||"优惠券"),1)])),_:2},1024)])),_:2},1024),L.value===e._id?(x(),w(l,{key:0,class:"coupon-check"},{default:h((()=>[I("✓")])),_:1})):j("",!0)])),_:2},1032,["class","onClick"])))),128)),C(l,{class:T(["coupon-item",{selected:null===L.value}]),onClick:a[9]||(a[9]=e=>L.value=null)},{default:h((()=>[C(l,{class:"coupon-info"},{default:h((()=>[C(s,{class:"coupon-amount"},{default:h((()=>[I("不使用")])),_:1}),C(s,{class:"coupon-desc"},{default:h((()=>[I("原价购买")])),_:1})])),_:1}),null===L.value?(x(),w(l,{key:0,class:"coupon-check"},{default:h((()=>[I("✓")])),_:1})):j("",!0)])),_:1},8,["class"])])),_:1})])),_:1}))])),_:1}),C(l,{class:"benefits-info"},{default:h((()=>[C(s,{class:"section-title"},{default:h((()=>[I("会员权益")])),_:1}),C(l,{class:"benefit-list"},{default:h((()=>[C(l,{class:"benefit-item"},{default:h((()=>[C(s,{class:"benefit-icon"},{default:h((()=>[I("🔥")])),_:1}),C(s,null,{default:h((()=>[I("查看所有推荐内容")])),_:1})])),_:1}),C(l,{class:"benefit-item"},{default:h((()=>[C(s,{class:"benefit-icon"},{default:h((()=>[I("💬")])),_:1}),C(s,null,{default:h((()=>[I("自动加入同步群聊")])),_:1})])),_:1}),C(l,{class:"benefit-item"},{default:h((()=>[C(s,{class:"benefit-icon"},{default:h((()=>[I("💎")])),_:1}),C(s,null,{default:h((()=>[I("7天专享会员权限")])),_:1})])),_:1})])),_:1})])),_:1}),C(l,{class:"popup-actions"},{default:h((()=>[C(c,{class:T(["purchase-btn",{loading:Z.value}]),disabled:Z.value,onClick:ge},{default:h((()=>[Z.value?(x(),w(s,{key:0},{default:h((()=>[I("处理中...")])),_:1})):(x(),w(s,{key:1},{default:h((()=>[I("确认开通 ¥"+E(ve().toFixed(2)),1)])),_:1}))])),_:1},8,["class","disabled"])])),_:1})])),_:1})])),_:1})):j("",!0),C(N)])),_:1})}}}),[["__scopeId","data-v-e053d9c4"]]);export{B as default};
